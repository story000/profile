<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>项目截图展示</title>
  <style>
    :root {
      --bg: #0b0c10;
      --card: #111318;
      --muted: #8a92a6;
      --text: #e8edf6;
      --brand: #5c8dff;
      --border: #1e2230;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    * { box-sizing: border-box; }
    body { 
      margin: 0; 
      padding: 20px; 
      background: var(--bg); 
      color: var(--text); 
      font-family: 'Inter', system-ui, sans-serif; 
      line-height: 1.6;
    }
    
    .container { max-width: 1200px; margin: 0 auto; }
    .header { text-align: center; margin-bottom: 40px; }
    .header h1 { margin: 0 0 10px; color: var(--brand); }
    .back-btn { 
      display: inline-block; 
      padding: 8px 16px; 
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 8px; 
      color: var(--text); 
      text-decoration: none; 
      margin-bottom: 20px;
    }
    .back-btn:hover { opacity: 0.8; }
    
    .gallery-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
      gap: 20px; 
    }
    
    .image-item { 
      background: var(--card); 
      border: 1px solid var(--border); 
      border-radius: 12px; 
      overflow: hidden; 
      box-shadow: var(--shadow);
      transition: transform 0.2s ease;
    }
    .image-item:hover { transform: translateY(-2px); }
    
    .image-container { 
      width: 100%; 
      height: 200px; 
      overflow: hidden; 
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .image-container img { 
      width: 100%; 
      height: 100%; 
      object-fit: cover; 
      cursor: pointer;
    }
    .image-placeholder {
      color: var(--muted);
      text-align: center;
      font-size: 14px;
    }
    
    .image-info { padding: 16px; }
    .image-title { margin: 0 0 8px; font-size: 16px; font-weight: 600; }
    .image-desc { margin: 0; color: var(--muted); font-size: 14px; }
    
    /* Modal for full-size images */
    .modal { 
      display: none; 
      position: fixed; 
      z-index: 1000; 
      left: 0; 
      top: 0; 
      width: 100%; 
      height: 100%; 
      background: rgba(0,0,0,0.9);
    }
    .modal.show { display: flex; align-items: center; justify-content: center; }
    .modal img { max-width: 90%; max-height: 90%; object-fit: contain; }
    .modal-close { 
      position: absolute; 
      top: 20px; 
      right: 30px; 
      color: white; 
      font-size: 30px; 
      cursor: pointer; 
    }
    
    .no-images { 
      text-align: center; 
      color: var(--muted); 
      margin: 60px 0; 
      font-size: 18px;
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-btn">← 返回作品集</a>
    
    <div class="header">
      <h1 id="project-title">项目截图</h1>
      <p id="project-desc">项目详细展示</p>
    </div>
    
    <div id="gallery-container">
      <div class="no-images">加载中...</div>
    </div>
  </div>
  
  <!-- Modal for full-size images -->
  <div class="modal" id="imageModal">
    <span class="modal-close" id="modalClose">&times;</span>
    <img id="modalImage" src="" alt="Full size image">
  </div>

  <script>
    let portfolioData = null;
    
    // Get project ID from URL
    function getProjectId() {
      const params = new URLSearchParams(window.location.search);
      return params.get('project') || 'aivc-system';
    }
    
    // Get display name from filename (remove extension)
    function getDisplayName(filename) {
      return filename.replace(/\.[^/.]+$/, "");
    }
    
    // Load portfolio data
    async function loadPortfolioData() {
      try {
        const response = await fetch('./portfolio_config.json');
        portfolioData = await response.json();
        const projectId = getProjectId();
        displayProject(projectId);
      } catch (error) {
        console.error('Error loading portfolio data:', error);
        document.getElementById('gallery-container').innerHTML = 
          '<div class="no-images">加载失败，请刷新页面重试</div>';
      }
    }
    
    // Display project info and images
    function displayProject(projectId) {
      const project = portfolioData.projects.find(p => p.id === projectId);
      if (!project) {
        document.getElementById('gallery-container').innerHTML = 
          '<div class="no-images">项目不存在</div>';
        return;
      }
      
      document.getElementById('project-title').textContent = project.title;
      document.getElementById('project-desc').textContent = project.tagline;
      document.title = `${project.title} - 项目截图`;
      
      loadProjectImages(projectId, project);
    }
    
    // Load images for a project
    async function loadProjectImages(projectId, project) {
      const galleryContainer = document.getElementById('gallery-container');
      
      try {
        // Load image list from static JSON file
        const response = await fetch('./images-list.json');
        if (response.ok) {
          const allImages = await response.json();
          const projectConfig = allImages[projectId] || { images: [] };
          const projectImages = projectConfig.images || projectConfig; // 兼容旧格式
          displayImages(projectImages, projectId, galleryContainer);
          return;
        }
      } catch (error) {
        console.error('Error loading image list:', error);
      }
      
      // Fallback if JSON file doesn't exist
      displayImages([], projectId, galleryContainer);
    }
    
    // Display images in gallery
    function displayImages(imageList, projectId, container) {
      if (imageList.length === 0) {
        container.innerHTML = `
          <div class="no-images">
            <p>暂无截图</p>
            <p style="font-size: 14px; color: var(--muted);">
              请将图片文件放入 <code>images/${projectId}/</code> 文件夹中
            </p>
          </div>
        `;
        return;
      }
      
      const imagePath = `./images/${projectId}/`;
      container.innerHTML = `
        <div class="gallery-grid">
          ${imageList.map(filename => `
            <div class="image-item">
              <div class="image-container">
                <img src="${imagePath + filename}" alt="${getDisplayName(filename)}" onclick="openModal('${imagePath + filename}')" />
              </div>
              <div class="image-info">
                <h3 class="image-title">${getDisplayName(filename)}</h3>
              </div>
            </div>
          `).join('')}
        </div>
      `;
    }
    
    // Modal functions
    function openModal(imageSrc) {
      const modal = document.getElementById('imageModal');
      const modalImage = document.getElementById('modalImage');
      modalImage.src = imageSrc;
      modal.classList.add('show');
    }
    
    function closeModal() {
      const modal = document.getElementById('imageModal');
      modal.classList.remove('show');
    }
    
    // Event listeners
    document.getElementById('modalClose').addEventListener('click', closeModal);
    document.getElementById('imageModal').addEventListener('click', (e) => {
      if (e.target === e.currentTarget) closeModal();
    });
    
    // Initialize
    document.addEventListener('DOMContentLoaded', loadPortfolioData);
  </script>
</body>
</html>